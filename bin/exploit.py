import time
import imp
from modules.exploit import sipddos, eavesdrop, bruteforce_login, bruteforce_ssh
from modules.initial import clear
from py_console import console
import sys

default_username_list = 'data/wordlist/username.txt'
default_password_list = 'data/wordlist/rockyou.txt'
default_username = 'root'

def sipddos(ip,port,duration):
    print("Start Flood DDoS Attack")
    ip = str(ip)
    port = int(port)
    duration = int(duration)
    ddos = sipddos.send_packets(ip,port,duration)
    if ddos is not None:
        return ddos
    else:
        return -1

def eavesdrop():
    filename = time.time()
    eavesdrop.eavesdropping(filename)

def brf_login(ip, default_username_list, default_password_list):
    try:
        bruteforce_login.bruteforcelogin(ip, default_username_list, default_password_list)
    except Exception as e:
        console.error("An Error Occurred!!!")
        console.error(e)
        sys.exit(1)
    except:
        console.error("Unexpected Error Occurred!!!")
        sys.exit(1)

def brf_ssh(ip, default_password_list, default_username):
    try:
        bruteforce_ssh.bruteforce(ip, default_password_list, default_username)
    except Exception as e:
        console.error("An Error Occurred!!!")
        console.error(e)
        sys.exit(1)
    except:
        console.error("Unexpected Error Occurred!!!")
        sys.exit(1)

def dirfuzzing():
    pass

def exploit(ip):
    pass